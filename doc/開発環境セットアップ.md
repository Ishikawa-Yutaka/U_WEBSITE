# 開発環境セットアップガイド

U_WEBプロジェクトの開発環境構築手順

---

## 前提条件

- macOS（Darwin 23.5.0）
- Homebrew インストール済み
- GitHub アカウント
- エックスサーバー契約済み

---

## 開発環境の全体像

```
【ローカル開発】
Local (WordPress環境)
↓ 開発・テスト
Git管理フォルダ (wp_code/)
↓ commit & push
GitHub (バージョン管理・バックアップ)
↓ デプロイ
エックスサーバー (本番環境)
```

---

## セットアップ手順

### 1. Localのインストール

**Homebrewでインストール（推奨）:**
```bash
brew install --cask local
```

**または公式サイトからダウンロード:**
https://localwp.com/

**起動:**
```bash
open -a Local
```

---

### 2. WordPressサイトの作成

**Localアプリで:**
1. 左下の「+」ボタンをクリック
2. サイト名入力: `U_WEBSITE`
3. 環境設定: **Preferred** を選択
   - PHP: 8.2+
   - Webサーバー: Nginx
   - MySQL: 8.0+
4. WordPress設定:
   - Username: `admin`
   - Password: 任意の強固なパスワード
   - Email: 自分のメールアドレス
5. 「Add Site」をクリック（1-2分で完了）

**作成後のパス:**
```
~/Local Sites/U_WEBSITE/
├── app/
│   └── public/          # WordPress本体
│       ├── wp-content/
│       │   ├── themes/  # テーマフォルダ
│       │   └── plugins/ # プラグインフォルダ
│       └── wp-config.php
├── conf/                # サーバー設定
└── logs/                # ログファイル
```

---

### 3. Git管理フォルダの準備

**既存のプロジェクトをクローン:**
```bash
cd /Users/Uni/Uni_MacBookAir/SITE_U-WEB/
git clone https://github.com/Ishikawa-Yutaka/U_WEBSITE.git wp_code
cd wp_code
```

**または新規作成:**
```bash
mkdir -p /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code
cd /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code
git init
```

**フォルダ構成:**
```
wp_code/
├── .git/               # Git管理情報
├── .gitignore          # 除外設定
├── README.md           # プロジェクト概要
├── doc/                # ドキュメント
├── sample_code/        # 元のHTMLデザイン
└── themes/             # カスタムテーマ
    └── u-web-theme/
```

---

### 4. カスタムテーマの作成

**ステップ1: テーマフォルダ作成**
```bash
mkdir -p ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme
```

**ステップ2: 必須ファイル作成**

**style.css:**
```css
/*
Theme Name: U_WEB Theme
Theme URI: https://github.com/Ishikawa-Yutaka/U_WEBSITE
Author: Ishikawa Yutaka
Description: 島根県西部を拠点としたWeb制作企業のカスタムテーマ
Version: 1.0.0
License: GPL v2 or later
Text Domain: u-web-theme
*/
```

**index.php:**
```php
<!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
    <meta charset="<?php bloginfo('charset'); ?>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?php bloginfo('name'); ?></title>
    <?php wp_head(); ?>
</head>
<body>
    <!-- サイトコンテンツ -->
    <?php wp_footer(); ?>
</body>
</html>
```

**functions.php:**
```php
<?php
function u_web_theme_setup() {
    add_theme_support('title-tag');
    add_theme_support('post-thumbnails');
}
add_action('after_setup_theme', 'u_web_theme_setup');
```

---

### 5. テーマの有効化

**WordPress管理画面:**
1. Localアプリで「ADMIN」ボタンをクリック
2. ログイン（設定したユーザー名・パスワード）
3. 左メニュー「外観」→「テーマ」
4. 「U_WEB Theme」を探す
5. 「有効化」をクリック

**サイト確認:**
- Localアプリで「OPEN SITE」をクリック

---

### 6. Git管理とLocalの連携

**方法A: シンボリックリンク（開発中のみ推奨）**
```bash
# Git管理フォルダにテーマを配置
mkdir -p /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code/themes
cp -r ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme \
      /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code/themes/

# Localのテーマフォルダを削除
rm -rf ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme

# シンボリックリンク作成
ln -s /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code/themes/u-web-theme \
      ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme
```

**方法B: 手動コピー（シンプル）**
```bash
# 編集後、Git管理フォルダにコピー
cp -r ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme \
      /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code/themes/

# Git commit
cd /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code
git add themes/
git commit -m "テーマ更新"
git push origin main
```

---

### 7. 必須プラグインのインストール

**WordPress管理画面で:**
1. 左メニュー「プラグイン」→「新規プラグインを追加」
2. 以下をインストール＆有効化:

**必須プラグイン:**
- **All-in-One WP Migration** - サーバー移行用
- **Contact Form 7** - お問い合わせフォーム
- **Yoast SEO** - SEO対策（任意）

**インストール方法:**
```
検索バーに「All-in-One WP Migration」と入力
↓
「今すぐインストール」をクリック
↓
「有効化」をクリック
```

---

## 日常の開発フロー

### 1. 開発開始
```bash
# Localアプリでサイトを起動
# 「START SITE」ボタンをクリック
```

### 2. テーマファイル編集
```bash
# VSCodeなどで編集
open ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme
```

### 3. ブラウザで確認
```
Localアプリで「OPEN SITE」をクリック
または
http://uwebsite.local/
```

### 4. Git commit
```bash
cd /Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code

# テーマをGit管理フォルダにコピー（シンボリックリンク未使用の場合）
cp -r ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/u-web-theme \
      ./themes/

# Git commit
git add themes/
git commit -m "今日の作業内容"
git push origin main
```

---

## 本番環境への移行

### All-in-One WP Migrationを使用（推奨）

**ステップ1: エクスポート（Local側）**
```
WordPress管理画面
↓
All-in-One WP Migration → Export
↓
Export To → File
↓
.wpress ファイルがダウンロードされる
```

**ステップ2: エックスサーバーでWordPressインストール**
```
サーバーパネル
↓
WordPress簡単インストール
↓
ドメイン選択
↓
サイト情報入力
↓
インストール実行
```

**ステップ3: インポート（サーバー側）**
```
サーバー側WordPress管理画面
↓
All-in-One WP Migration → Import
↓
.wpress ファイルをアップロード
↓
完了！
```

**ステップ4: SSL化**
```
サーバーパネル
↓
SSL設定 → 無料独自SSL設定
↓
WordPress管理画面
  → 設定 → 一般
  → WordPressアドレス: https://〜
  → サイトアドレス: https://〜
```

---

## トラブルシューティング

### Localが起動しない

```bash
# Localを再インストール
brew uninstall --cask local
brew install --cask local
```

---

### テーマが表示されない

```
WordPress管理画面
↓
外観 → テーマ
↓
「U_WEB Theme」が表示されているか確認
↓
表示されていない場合:
  - style.css のヘッダー情報を確認
  - ファイルパスを確認
```

---

### GitHubへのpushが失敗する

```bash
# リモートリポジトリを確認
git remote -v

# 再設定
git remote set-url origin https://github.com/Ishikawa-Yutaka/U_WEBSITE.git

# 再push
git push origin main
```

---

## プロジェクト完了後の環境削除

### Localフォルダの削除
```bash
# 容量節約（500MB〜1GB）
rm -rf ~/Local\ Sites/U_WEBSITE
```

### Git管理フォルダは維持
```bash
# これは残す（10MB〜30MB程度）
/Users/Uni/Uni_MacBookAir/SITE_U-WEB/wp_code/
```

---

## 環境再構築手順

### 新しいPCでの開発再開

```bash
# 1. Localをインストール
brew install --cask local

# 2. GitHubからクローン
git clone https://github.com/Ishikawa-Yutaka/U_WEBSITE.git
cd U_WEBSITE

# 3. Localで新規サイト作成

# 4. All-in-One WP Migration で .wpress をインポート

# 5. テーマをコピー
cp -r themes/u-web-theme \
      ~/Local\ Sites/U_WEBSITE/app/public/wp-content/themes/

# 完了！
```

---

## チェックリスト

### 初回セットアップ
- [ ] Localインストール完了
- [ ] WordPressサイト作成完了
- [ ] Git管理フォルダ作成完了
- [ ] GitHubリポジトリ接続完了
- [ ] カスタムテーマ作成完了
- [ ] テーマ有効化完了
- [ ] 必須プラグインインストール完了

### 日常開発
- [ ] 作業開始前に git pull
- [ ] 編集後にブラウザで確認
- [ ] 作業終了時に git commit & push
- [ ] 大きな変更後に .wpress エクスポート

### 本番移行前
- [ ] 最終版を .wpress でエクスポート
- [ ] GitHubに最新版プッシュ
- [ ] README.md 更新
- [ ] ドキュメント整備

---

## 参考リンク

- [Local 公式サイト](https://localwp.com/)
- [WordPress Codex 日本語版](https://wpdocs.osdn.jp/)
- [All-in-One WP Migration](https://wordpress.org/plugins/all-in-one-wp-migration/)
- [エックスサーバー マニュアル](https://www.xserver.ne.jp/manual/)
- [GitHub リポジトリ](https://github.com/Ishikawa-Yutaka/U_WEBSITE)

---

**これで開発環境のセットアップは完了です！**
